<?xml version="1.0" encoding="utf-8" ?>
<pages:PopupPage
    x:Class="BA_MobileGPS.Core.Views.UploadVideoPage"
    xmlns="http://xamarin.com/schemas/2014/forms"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:animation="clr-namespace:Rg.Plugins.Popup.Animations;assembly=Rg.Plugins.Popup"
    xmlns:converter="clr-namespace:BA_MobileGPS.Core"
    xmlns:ffImage="clr-namespace:FFImageLoading.Forms;assembly=FFImageLoading.Forms"
    xmlns:icons="clr-namespace:BA_MobileGPS.Core.Controls"
    xmlns:input="clr-namespace:Syncfusion.XForms.TextInputLayout;assembly=Syncfusion.Core.XForms"
    xmlns:pages="http://rotorgames.com"
    Title="Tải về server"
    BackgroundColor="White"
    BackgroundInputTransparent="False"
    CloseWhenBackgroundIsClicked="False">
    <pages:PopupPage.Animation>
        <animation:MoveAnimation
            DurationIn="0"
            DurationOut="0"
            PositionIn="Bottom"
            PositionOut="Bottom" />
    </pages:PopupPage.Animation>
    <pages:PopupPage.Resources>
        <ResourceDictionary>
            <converter:TimeSecondConverter x:Key="TimeSecondConverter" />
        </ResourceDictionary>
    </pages:PopupPage.Resources>
    <Grid RowDefinitions="Auto,Auto,*,Auto">
        <Grid Grid.Row="0" StyleClass="TitleBarGrid">
            <StackLayout
                Margin="0"
                HorizontalOptions="FillAndExpand"
                Orientation="Horizontal"
                Spacing="8"
                VerticalOptions="CenterAndExpand">
                <icons:IconView Source="ic_close.png" StyleClass="TopIconView">
                    <icons:IconView.GestureRecognizers>
                        <TapGestureRecognizer Command="{Binding ClosePageCommand}" />
                    </icons:IconView.GestureRecognizers>
                </icons:IconView>
            </StackLayout>
            <Label
                FontSize="16"
                HorizontalOptions="Center"
                Text="Xem lại video"
                TextColor="White"
                VerticalOptions="Center" />
        </Grid>
        <StackLayout Grid.Row="1" Padding="20,10,20,10">
            <Label
                FontAttributes="Italic"
                HorizontalOptions="Center"
                HorizontalTextAlignment="Center"
                Text="Video tải trực tiếp từ thiết bị và được chia nhỏ thành các phần để tối ưu đường truyền và dung lượng lưu trữ. Quý khách có thể chọn phần video muốn tải về." />
            <Label
                FontAttributes="Bold"
                FontFamily="{StaticResource myFontLatoBold}"
                FontSize="15"
                HorizontalOptions="Center"
                HorizontalTextAlignment="Center"
                Text="DANH SÁCH CÁC PHẦN VIDEO"
                TextColor="{StaticResource PrimaryColor}" />

            <Label HorizontalOptions="Center" HorizontalTextAlignment="Center">
                <Label.FormattedText>
                    <FormattedString>
                        <Span Text="Quý khách đang tải video của xe: " />
                        <Span Text="{Binding VideoRestreamInfo.VehicleName}" />
                        <Span Text=" - " />
                        <Span Text="Kênh " />
                        <Span Text="{Binding VideoRestreamInfo.Channel}" />
                    </FormattedString>
                </Label.FormattedText>
            </Label>
        </StackLayout>
        <StackLayout
            Grid.Row="2"
            Padding="10"
            Spacing="20">
            <icons:HorizontalList
                Grid.Row="0"
                Margin="0"
                Padding="0"
                IsClippedToBounds="True"
                ItemsSource="{Binding ListVideo, Mode=TwoWay}"
                Spacing="10"
                VerticalOptions="FillAndExpand">
                <icons:HorizontalList.ItemTemplate>
                    <DataTemplate>
                        <Grid
                            ColumnDefinitions="Auto,Auto,*"
                            ColumnSpacing="20"
                            RowDefinitions="Auto,Auto"
                            RowSpacing="10">
                            <CheckBox
                                Grid.Row="0"
                                Grid.Column="0"
                                IsChecked="{Binding IsSelected}" />
                            <ffImage:CachedImage
                                Grid.Row="0"
                                Grid.Column="1"
                                Source="ic_cameraonline.png"
                                WidthRequest="40" />
                            <StackLayout
                                Grid.Row="0"
                                Grid.Column="2"
                                HorizontalOptions="Start">
                                <Label
                                    HorizontalOptions="Start"
                                    HorizontalTextAlignment="Start"
                                    Text="{Binding FileName}" />
                                <StackLayout Orientation="Horizontal">
                                    <Label
                                        FontSize="12"
                                        HorizontalOptions="Start"
                                        HorizontalTextAlignment="Start"
                                        Text="{Binding StartTime, Converter={StaticResource TimeSecondConverter}}"
                                        TextColor="#18A0FB" />
                                    <Label
                                        FontSize="12"
                                        HorizontalOptions="Start"
                                        HorizontalTextAlignment="Start"
                                        Text="-"
                                        TextColor="#18A0FB" />
                                    <Label
                                        FontSize="12"
                                        HorizontalOptions="Start"
                                        HorizontalTextAlignment="Start"
                                        Text="{Binding EndTime, Converter={StaticResource TimeSecondConverter}}"
                                        TextColor="#18A0FB" />
                                </StackLayout>
                            </StackLayout>
                            <input:SfTextInputLayout
                                Grid.Row="1"
                                Grid.Column="0"
                                Grid.ColumnSpan="3"
                                ErrorText="{Binding Notes.ErrorFirst}"
                                HasError="{Binding Notes.IsNotValid}"
                                OutlineCornerRadius="20">
                                <Entry
                                    HeightRequest="45"
                                    MaxLength="1000"
                                    Placeholder="Nhập ghi chú"
                                    Text="{Binding Note}" />
                            </input:SfTextInputLayout>
                        </Grid>
                    </DataTemplate>
                </icons:HorizontalList.ItemTemplate>
            </icons:HorizontalList>
        </StackLayout>
        <StackLayout
            Grid.Row="3"
            Spacing="0"
            VerticalOptions="End">
            <BoxView
                HeightRequest="1"
                HorizontalOptions="FillAndExpand"
                Color="Gray" />
            <Button
                Margin="10"
                Command="{Binding UploadVideoCommand}"
                CornerRadius="20"
                HeightRequest="40"
                HorizontalOptions="Center"
                Text="Tải về Server"
                VerticalOptions="Center"
                WidthRequest="150" />
        </StackLayout>
    </Grid>
</pages:PopupPage>